<!DOCTYPE html>

<!--This will create the webpage for the use_model.ts code-->
<html lang = "en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
    <link rel="stylesheet" href="style.css">
    <title>User-Prompted-Melody</title>
    <script> var exports = {}; </script>
    <script type = "module">
        import {
            Call_Music,
            Mel_prompt,
            store_Mel,
            retrieve_Mel,
            start_Mel,
            time_Mel,
            stop_Mel,
            Melody,
            MusicVAE
        } from './use_model.js';

        window.Call_Music = Call_Music;
        window.Mel_prompt = Mel_prompt;
        window.store_Mel = store_Mel;
        window.retrieve_Mel = retrieve_Mel;
        window.start_Mel = start_Mel;
        window.time_Mel = time_Mel;
        window.stop_Mel = stop_Mel;
        window.Melody = Melody;
        window.MusicVAE = MusicVAE;

    </script>
</head>

<!--TODO: Create the rest of the code for the function in ts to work on HTML-->
<body>
    <h1>User Prompted Melody</h1>
    <p>Type in the melody prompt:</p>
    <!--This will allow the user to type the prompt-->
    <input type="text" id="Melody" name="Melody-Name">

    <p>Melody Function called:</p>
    <button onclick = "Call_Music(document.getElementById('Melody').value)">Calls the Melody</button>
    <br>
    <p>Calls the prompt:</p>
    <button onclick = "Mel_prompt(document.getElementById('Melody').value)">Call prompt</button>

    <p>Called Melody is being stored:</p>
    <button onclick = "store_Mel()">Stores the Melody</button>


    <p> The Melody is now stored.</p>

    <p>Melody is being retrived from storage and is being started</p>

    <button onclick = "retrieve_Mel()">Retrieve Melody</button>


    <p> This gets the piano keys and then generates based on user click:</p>
    <button class = "simulate-key" data-note="A">A Key</button>
    <button class = "simulate-key" data-note="B">B Key</button>
    <button class = "simulate-key" data-note="C">C Key</button>
    <button class = "simulate-key" data-note="D">D Key</button>
    <button class = "simulate-key" data-note="E">E Key</button>
    <button class = "simulate-key" data-note="F">F Key</button>
    <button class = "simulate-key" data-note="G">G Key</button>
    <button class = "gen_mel">Generate melody</button>
    <script>
        window.addEventListener('DOMContentLoaded', () => { 
            const simulate_key = document.querySelectorAll(".simulate-key")

            simulate_key.forEach(key =>  {
                key.addEventListener('click', () => {
                    const note = key.dataset.note;
                    console.log(`play the note ${note}`);
                });
            });
            genMel();
        });

        function playMel(){
            const play = new Melody(MusicVAE)
        }

        function genMel(){
            const gen_key = document.querySelectorAll(".gen_mel")
            gen_key.forEach(new_key => {
                new_key.addEventListener('click', () => {
                    console.log("Generate the melody:");
                    const generate = new Melody(MusicVAE);
                    console.log(MusicVAE.melody);
                });
            });
        }
    </script>

    <p>Retrieved melody is being played</p> 

    <button onclick = "start_Mel()">Melody has been started</button>

    <p>Melody has been stopped.</p>
    <button onclick = "stop_Mel()">Melody has been stopped</button>

</body>
</html>
